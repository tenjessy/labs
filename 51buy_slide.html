<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>test</title>
<link rel="stylesheet" type="text/css" href="http://st.icson.com/51buy_v3/css/gb.css?v=20130401201" />
<link rel="stylesheet" type="text/css" href="http://st.icson.com/51buy_v3/css/index.css?v=20130401101" />
</head>

<body>
	<div class="index_slide" id="index_slide" hotname="I.INDEX.SLIDEPLAY">
	<div id="slide_1365771698277" class="main_slide">
		<ul class="body_slide">
			<li>
				<a ytag="07011" href="http://event.51buy.com/event/7307a1a5.html?cp-ptss=41-2-1101-t" class="item_807_327" target="_blank" hotname="NA">
					<img alt="放心购 全网底价" title="放心购 全网底价" src="http://img1.icson.com/ICSONAD/201304/1_big20130411172738908498.jpg" />
				</a>
			</li>
			<li>
				<a ytag="07021" href="http://event.51buy.com/event/700214b8.html?cp-ptss=42-1-1818-t" class="item_807_327" target="_blank" hotname="NA">
					<img src="http://img2.icson.com/ICSONAD/201304/1_big20130407194054578142.jpg" alt="合约机-理性消费" title="合约机-理性消费" />
				</a>
			</li>
			<li>
				<a ytag="07031" href="http://event.51buy.com/event/7196fe5e.html?cp-ptss=43-1-1534-t" class="item_807_327" target="_blank" hotname="NA">
					<img src="http://img2.icson.com/ICSONAD/201304/1_big20130411100504601970.jpg" alt="海尔专场" title="海尔专场" />
				</a>
			</li>
			<li>
				<a ytag="07041" href="http://event.51buy.com/event/7024006c.html?cp-ptss=45-1-1010-t" class="item_477_327" target="_blank" hotname="NA">
					<img alt="旗舰手机" title="旗舰手机" src="http://img2.icson.com/ICSONAD/201304/1_big20130410165151622924.jpg" style="top: 0px; z-index: 1;" />
				</a>
				<a ytag="07042" href="http://event.51buy.com/event/7292f0e6.html?cp-ptss=22-1-1162-t" class="item_327_163" target="_blank" hotname="NA">
					<img alt="三星手机" title="三星手机" src="http://img2.icson.com/ICSONAD/201304/1_big20130412192451292715.jpg" />
				</a>
				<a ytag="07043" href="http://event.51buy.com/event/68679cd7.html?cp-ptss=45-1-1010-t" class="item_163_163" target="_blank" hotname="NA">
					<img alt="索尼" title="索尼" src="http://img2.icson.com/ICSONAD/201304/1_big20130409160342532553.jpg" />
				</a>
				<a ytag="07044" href="http://event.51buy.com/event/68149379.html?cp-ptss=22-1-1162-t" class="item_163_163" target="_blank" hotname="NA">
					<img alt="SONY储存特价" title="SONY储存特价" src="http://img1.icson.com/ICSONAD/201304/1_big20130409095910351936.jpg" style="top: -40px; z-index: 5;" />
				</a>
			</li>
			<li>
				<a ytag="07051" href="http://event.51buy.com/event/7039cc80.html?cp-ptss=46-2-919-t" class="item_807_327" target="_blank" hotname="NA">
					<img alt="百货周年庆" title="百货周年庆" src="http://img2.icson.com/ICSONAD/201304/1_big20130408103522283875.jpg" />
				</a>
			</li>
			<li>
				<a ytag="07061" href="http://event.51buy.com/event/7141817c.html?cp-ptss=44-1-1162-t" class="item_477_327" target="_blank" hotname="NA">
					<img alt="尼康专场" title="尼康专场" src="http://img2.icson.com/ICSONAD/201304/1_big20130409193713379837.jpg" />
				</a>
				<a ytag="07062" href="http://event.51buy.com/event/7079488b.html?cp-ptss=44-1-1162-t" class="item_327_163" target="_blank" hotname="NA">
					<img alt="苹果专场" title="苹果专场" src="http://img2.icson.com/ICSONAD/201304/1_big20130412162419257277.jpg" />
				</a>
				<a ytag="07063" href="http://event.51buy.com/event/68149379.html?cp-ptss=44-1-1162-t" class="item_163_163" target="_blank" hotname="NA">
					<img alt="索尼存储" title="索尼存储" src="http://img2.icson.com/ICSONAD/201304/1_big20130410105421246257.jpg" />
				</a>
				<a ytag="07064" href="http://event.51buy.com/event/68688a12.html?cp-ptss=44-1-1162-t" class="item_163_163" target="_blank" hotname="NA">
					<img alt="自驾" title="自驾" src="http://img2.icson.com/ICSONAD/201304/1_big20130409194126500736.jpg" />
				</a>
			</li>
		</ul>
		<div class="bor_slide">
			<ul class="ctrl">
				<li class="item0"></li>
				<li class="item1"></li>
				<li class="item2"></li>
				<li class="item3"></li>
				<li class="item4"></li>
				<li class="item5"></li>
			</ul>
		</div>
	</div>
</div>


<script type="text/javascript" src="http://st.icson.com/static_v1/js/jquery-1.5.1.min.js"></script>
<script type="text/javascript">

	;;;(function($, document){
		$.fn.slide = function(){
			var def = {
				control : null,
				time : 5000,
				duration : 800,
				delay : 8000,
				auto : true
			}

			var opts = $.extend({}, def, opts);
			var _this = $(this);

			// slide元素相关
			var slide_list = _this.find('ul.body_slide');
			var slide_child = slide_list.children();
			var slide_child_size = slide_child.size();
			var slide_child_height = slide_child.eq(0).height();
			var slide_last_height = slide_child_height * slide_child_size;

			// 按钮相关
			var control = _this.find('ul.ctrl li');

			var index = 0;
			// 时间相关
			var slide_timtout;
			var delay_timeout;

			/**
			 * 初始化
			 * @return {[type]} [description]
			 */
			function init(){
				// delay_timeout = setTimeout(slider, opts.delay);
				slider();

				// 鼠标在数字上切换，快速切换到指定的图片
				control.mouseover(function(){
					if(slide_timtout){
						clearTimeout(slide_timtout);
					}
					index = $(this).index();
					slider();
				});

				// 鼠标在slide区域移动，停止动画
				slide_list.mouseover(function(){
					if(slide_timtout){
						clearTimeout(slide_timtout);
					}
					return false;
				}).mouseout(function(){
					slide_timtout = setTimeout(slider, opts.time);
				});
			}

			

			/**
			 * 开始计算当前动画及跳到下一个动画
			 * @return {[type]} [description]
			 */
			function slider(){
				// clearTimeout(delay_timeout);
				var animate_callback;
				var scroll_top;
				var current_index = 0;
				// console.log(index);

				if(index === slide_child_size){
					var slide_first_item = slide_child.eq(0);
					var slide_first_item_top = slide_first_item.css({ 'position' : 'relative', 'top' : slide_last_height });
					
					animate_callback = function(){
						slide_first_item.css({ 'top' : '0px' });
						slide_list.css({ 'top' : '0px' });
					}

					scroll_top = -index * slide_child_height;
					current_index = index = 0;
				} else {
					scroll_top = -index * slide_child_height;
					animate_callback = '';
					current_index = index;
				}


				// console.log(current_index);
				// control.each(function(i){
				// 	control.eq(i).attr('class', 'item' + i);
				// });
				// 每次执行动画的时候，去除control当中的hover的className
				for(var i = 0; i < control.length; i++){
					control.eq(i).attr('class', 'item' + i);
				}
				var class_name = 'item' + current_index + '_hover';
				control.eq(current_index).addClass(class_name);

				slide_list.stop(true, true).animate({
					top : scroll_top
				}, opts.duration, animate_callback);
				index++;

				slide_timtout = setTimeout(slider, opts.time);
			}

			
			return init();
		}
	})(jQuery, document);

	$(function(){
		$('#index_slide').slide();
	});

</script>

</body>
</html>
